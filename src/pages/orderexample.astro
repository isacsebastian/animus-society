---
import Layout from "../layouts/Layout.astro";

// Datos de ejemplo del pago procesado
const orderData = {
  id: "8ac7a4a2997bf99001997d4b9bfa2153",
  paymentType: "DB",
  paymentBrand: "VISA",
  amount: "77.00",
  currency: "USD",
  merchantTransactionId: "ORD_MFYDOGU5_UYMHJZGT",
  result: {
    code: "000.100.112",
    description:
      "Request successfully processed in 'Merchant in Connector Test Mode'",
  },
  resultDetails: {
    AuthCode: "008930",
    ReferenceNbr: "250924_000075",
    BatchNo: "250924",
    TotalAmount: "77.00",
    ExtendedDescription: "Transaccion aprobada",
    clearingInstituteName: "Datafast",
    CardType: "MP",
    AcquirerTimestamp: "2025-09-24 19:52:44",
  },
  card: {
    bin: "420000",
    binCountry: "US",
    last4Digits: "0000",
    holder: "ANIMUSSOCIETY",
    expiryMonth: "07",
    expiryYear: "2026",
  },
  customer: {
    givenName: "Juan",
    surname: "Perez",
    middleName: "Pablo",
    merchantCustomerId: "USR123",
  },
  customParameters: {
    SHOPPER_VAL_BASEIMP: "68.75",
    SHOPPER_VAL_IVA: "8.25",
    SHOPPER_VAL_BASE0: "0.00",
  },
  timestamp: "2025-09-24 19:55:31+0000",
};

// Simular datos del plan
const planData = {
  name: "Animus Flow - Plan Mensual",
  description: "Plan mensual gimnasio",
  price: "77.00",
  period: "Mensual",
};
---

<Layout
  title="Orden Confirmada - Animus Society"
  description="Tu pago ha sido procesado exitosamente"
>
  <style>
    html,
    body {
      overflow: auto !important;
      height: auto !important;
    }
  </style>

  <div class="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
    <div class="max-w-4xl mx-auto mb-4">
      <a
        href="/"
        class="inline-flex items-center justify-center w-10 h-10 text-gray-600 hover:text-gray-900 hover:bg-white rounded-full transition-all duration-200 shadow-sm border border-gray-200"
      >
        <svg
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
      </a>
    </div>

    <div class="max-w-4xl mx-auto">
      <!-- Header de confirmación -->
      <div class="text-center mb-4">
        <div
          class="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4"
        >
          <svg
            class="w-8 h-8 text-green-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 13l4 4L19 7"></path>
          </svg>
        </div>
        <h1 class="text-3xl font-bold text-gray-900 mb-2">¡Pago Exitoso!</h1>
        <p class="text-gray-600">
          Tu suscripción ha sido activada correctamente
        </p>
      </div>

      <div class="grid lg:grid-cols-2 gap-8">
        <!-- Detalles de la Orden -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-6">
            Detalles de la Orden
          </h2>

          <div class="space-y-4">
            <!-- Plan Adquirido -->
            <div class="border-b border-gray-200 pb-4">
              <h3 class="font-medium text-gray-900 mb-2">Plan Adquirido</h3>
              <div class="flex justify-between items-start">
                <div>
                  <p class="font-medium text-gray-900">{planData.name}</p>
                  <p class="text-sm text-gray-600">{planData.description}</p>
                  <p class="text-sm text-gray-600">
                    Período: {planData.period}
                  </p>
                </div>
                <span class="text-lg font-semibold text-gray-900">
                  ${planData.price}
                </span>
              </div>
            </div>

            <!-- ID de Orden -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <h4 class="text-sm font-medium text-gray-700 mb-1">
                  ID de Orden
                </h4>
                <p
                  class="text-sm text-gray-900 font-mono bg-gray-50 p-2 rounded"
                >
                  {orderData.merchantTransactionId}
                </p>
              </div>
              <div>
                <h4 class="text-sm font-medium text-gray-700 mb-1">
                  Referencia
                </h4>
                <p
                  class="text-sm text-gray-900 font-mono bg-gray-50 p-2 rounded"
                >
                  {orderData.resultDetails.ReferenceNbr}
                </p>
              </div>
            </div>

            <!-- Fecha y Hora -->
            <div>
              <h4 class="text-sm font-medium text-gray-700 mb-1">
                Fecha y Hora
              </h4>
              <p class="text-sm text-gray-900">
                {
                  new Date(
                    orderData.resultDetails.AcquirerTimestamp
                  ).toLocaleString("es-ES", {
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                    hour: "2-digit",
                    minute: "2-digit",
                  })
                }
              </p>
            </div>

            <!-- Cliente -->
            <div>
              <h4 class="text-sm font-medium text-gray-700 mb-1">Cliente</h4>
              <p class="text-sm text-gray-900">
                {orderData.customer.givenName}
                {orderData.customer.middleName}
                {orderData.customer.surname}
              </p>
              <p class="text-sm text-gray-600">
                ID: {orderData.customer.merchantCustomerId}
              </p>
            </div>
          </div>
        </div>

        <!-- Información de Pago -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-6">
            Información de Pago
          </h2>

          <div class="space-y-4">
            <!-- Estado del Pago -->
            <div
              class="flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200"
            >
              <div class="flex items-center">
                <svg
                  class="w-5 h-5 text-green-600 mr-2"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="text-sm font-medium text-green-800">
                  {orderData.resultDetails.ExtendedDescription}
                </span>
              </div>
            </div>

            <!-- Método de Pago -->
            <div>
              <h4 class="text-sm font-medium text-gray-700 mb-2">
                Método de Pago
              </h4>
              <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                <div
                  class="flex items-center justify-center w-12 h-6 bg-white rounded border border-gray-200 text-blue-600 text-xs font-bold mr-3"
                >
                  {orderData.paymentBrand}
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-900">
                    •••• •••• •••• {orderData.card.last4Digits}
                  </p>
                  <p class="text-xs text-gray-600">
                    Vence: {orderData.card.expiryMonth}/{
                      orderData.card.expiryYear
                    }
                  </p>
                </div>
              </div>
            </div>

            <!-- Desglose de Pago -->
            <div class="border-t border-gray-200 pt-4">
              <h4 class="text-sm font-medium text-gray-700 mb-3">Desglose</h4>
              <div class="space-y-2">
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">Subtotal</span>
                  <span class="text-gray-900"
                    >${orderData.customParameters.SHOPPER_VAL_BASEIMP}</span
                  >
                </div>
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">IVA (12%)</span>
                  <span class="text-gray-900"
                    >${orderData.customParameters.SHOPPER_VAL_IVA}</span
                  >
                </div>
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">Base 0%</span>
                  <span class="text-gray-900"
                    >${orderData.customParameters.SHOPPER_VAL_BASE0}</span
                  >
                </div>
                <div
                  class="border-t border-gray-200 pt-2 flex justify-between font-semibold"
                >
                  <span class="text-gray-900">Total</span>
                  <span class="text-gray-900"
                    >${orderData.amount} {orderData.currency}</span
                  >
                </div>
              </div>
            </div>

            <!-- Detalles Técnicos -->
            <div class="border-t border-gray-200 pt-4">
              <h4 class="text-sm font-medium text-gray-700 mb-3">
                Detalles de la Transacción
              </h4>
              <div class="space-y-2 text-xs">
                <div class="flex justify-between">
                  <span class="text-gray-600">Código de Autorización</span>
                  <span class="text-gray-900 font-mono"
                    >{orderData.resultDetails.AuthCode}</span
                  >
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-600">Procesador</span>
                  <span class="text-gray-900"
                    >{orderData.resultDetails.clearingInstituteName}</span
                  >
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-600">Lote</span>
                  <span class="text-gray-900 font-mono"
                    >{orderData.resultDetails.BatchNo}</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Botones de Acción -->
      <div class="mt-6 flex flex-col sm:flex-row gap-4 justify-center">
        <a
          href="/"
          class="inline-flex items-center justify-center px-6 py-3 border border-gray-300 rounded-md shadow-sm text-base font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 transition-colors"
        >
          Volver al Inicio
        </a>
        <button
          onclick="window.print()"
          class="inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-gray-900 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 transition-colors"
        >
          <svg
            class="w-5 h-5 mr-2"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"
            ></path>
          </svg>
          Imprimir Recibo
        </button>
      </div>
    </div>
  </div>
</Layout>

<style>
  @media print {
    .no-print {
      display: none !important;
    }

    body {
      background: white !important;
    }

    .bg-gray-50 {
      background: white !important;
    }
  }
</style>
